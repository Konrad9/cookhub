{% extends 'cookhub/base.html' %}
{% load staticfiles %}

{% block title_block %}
	Add Recipe
{% endblock %}

{% block body_block %}
{% if recipe.user == user %}
    <div class="container p-4">
        <h1 style="color: white; text-transform: uppercase" class="jumbotron-heading">Create a recipe</h1>
    </div>

    <div class="container p-4" style="background-color: #1c1c1c; color:white; border-radius: 1.2rem">
		<form id="recipe_form" method="post" action="{% url 'cookhub:add_recipe' recipe.id %}" enctype="multipart/form-data"> 
			{% csrf_token %}
			{% for hidden in recipe_form.hidden_fields %}
				{{ hidden }}
			{% endfor %}
			<img src="" id="preview" width="200px" />

			
			{% for field in recipe_form.visible_fields %}
				{{ field.errors }}
				{{ field.help_text }}
				{{ field }} <br />
			{% endfor %}
			<style>
    		#id_categories {
        		columns: 3; 
        		webkit-columns: 3; 
        		moz-columns: 3;
        	}
		</style>
			
		<input type="submit" name="addRecipe" value="Finished Recipe" />
		<script type="text/javascript"> // displays the uploaded photo right away
    function readURL(input) {
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
                $('#preview').attr('src', e.target.result);
            }
            reader.readAsDataURL(input.files[0]);
        }
    }

    $("#id_photo").change(function(){
        readURL(this);
    });

</script>
		</form>
			<form id="category_form">
				{% csrf_token %}
				{% for field in  category_form.visible_fields %}
					{{ field.errors }}
					{{ field.help_text }}
					{{ field }} <br />
				{% endfor %}
				<button id="addCategory" >Add Category</button>
			</form>
			<script src="{% static 'js/recipeAddCategory.js' %}"></script>
			<script>
        			$("button#addCategory").click( function(event) {
            			event.preventDefault();
            			addCat("{% url 'cookhub:add_category' %}");
            		});
			</script>
			
			<h2>Ingredients for the recipe</h2>
			<ul id="ingredientList">
			</ul>
			<script src="{% static 'js/recipeIngredientRemove.js' %}" ></script>
			<script>
			$("body").on("click", "button.removeIngredient", function () {
    			remIng("{% url 'cookhub:remove_ingredient' %}", "{{ csrf_token }}", this);
    		});
    		</script>
			
			<form id="ingredient_form">
				{% csrf_token %}
				{% for field in ingredient_form.visible_fields %}
					{{ field.errors }}
					{{ field.help_text }}
					{{ field }} <br />
				{% endfor %}
				<button id="addIngredient" >Add Ingredient</button>
			</form>
			<script src="{% static 'js/recipeAddIngredient.js' %}"></script>
			<script>
        			$("button#addIngredient").click( function(event) {
            			event.preventDefault();
            			addIng("{% url 'cookhub:add_ingredient' %}", this, "{{ recipe.id }}");
            		});
			</script>
		
		
	</div>
    <style>
    input {
        margin-bottom: 10px;
    }
    </style>
{% endif %}
{% endblock %}